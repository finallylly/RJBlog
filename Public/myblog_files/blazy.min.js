/*!
  hey, [be]Lazy.js - v1.4.1 - 2015.10.12
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
(function(h,f){"function"===typeof define&&define.amd?define(f):"object"===typeof exports?module.exports=f():h.Blazy=f()})(this,function(){function h(a){var c=a._util;c.images=[].slice.call(document.querySelectorAll(a.options.selector));c.count=c.images.length;c.destroyed&&(c.destroyed=!1,a.options.container&&k(a.options.container,function(a){l(a,"scroll",c.validateT)}),l(window,"resize",c.saveViewportOffsetT),l(window,"resize",c.validateT),l(window,"scroll",c.validateT));f(a)}function f(a){for(var c=a._util,b=0;b<c.count;b++){var d=c.images[b],g=d.getBoundingClientRect();if(g.right>=e.left&&g.bottom>=e.top&&g.left<=e.right&&g.top<=e.bottom||-1!==(" "+d.className+" ").indexOf(" "+a.options.successClass+" "))a.load(d),c.images.splice(b,1),c.count--,b--}0===c.count&&a.destroy()}function t(a,c,b){if(c||0<a.offsetWidth&&0<a.offsetHeight)if(c=a.getAttribute(n)||a.getAttribute(b.src)){c=c.split(b.separator);var d=c[p&&1<c.length?1:0];c=new Image;k(b.breakpoints,function(b){a.removeAttribute(b.src)});a.removeAttribute(b.src);c.onerror=function(){b.error&&b.error(a,"invalid");a.className=a.className+" "+b.errorClass};c.onload=function(){"img"===a.nodeName.toLowerCase()?a.src=d:a.style.backgroundImage='url("'+d+'")';a.className=a.className+" "+b.successClass;b.success&&b.success(a)};c.src=d}else b.error&&b.error(a,"missing"),a.className=a.className+" "+b.errorClass}function q(a){e.bottom=(window.innerHeight||document.documentElement.clientHeight)+a;e.right=(window.innerWidth||document.documentElement.clientWidth)+a}function l(a,c,b){a.attachEvent?a.attachEvent&&a.attachEvent("on"+c,b):a.addEventListener(c,b,!1)}function m(a,c,b){a.detachEvent?a.detachEvent&&a.detachEvent("on"+c,b):a.removeEventListener(c,b,!1)}function k(a,c){if(a&&c)for(var b=a.length,d=0;d<b&&!1!==c(a[d],d);d++);}function r(a,c,b){var d=0;return function(){var g=+new Date;g-d<c||(d=g,a.apply(b,arguments))}}var n,e,p;return function(a){if(!document.querySelectorAll){var c=document.createStyleSheet();document.querySelectorAll=function(a,b,d,e,f){f=document.all;b=[];a=a.replace(/\[for\b/gi,"[htmlFor").split(",");for(d=a.length;d--;){c.addRule(a[d],"k:v");for(e=f.length;e--;)f[e].currentStyle.k&&b.push(f[e]);c.removeRule(0)}return b}}var b=this,d=b._util={};d.images=[];d.destroyed=!0;b.options=a||{};b.options.error=a.error||!1;b.options.offset=a.offset||100;b.options.success=a.success||!1;b.options.selector=a.selector||".b-lazy";b.options.separator=a.separator||"|";b.options.container=a.container?document.querySelectorAll(a.container):!1;b.options.errorClass=a.errorClass||"b-error";b.options.breakpoints=a.breakpoints||!1;b.options.successClass=a.successClass||"b-loaded";b.options.src=n=a.src||"data-src";p=1<window.devicePixelRatio;e={};e.top=0-b.options.offset;e.left=0-b.options.offset;b.revalidate=function(){h(this)};b.load=function(a,b){-1===(" "+a.className+" ").indexOf(" "+this.options.successClass+" ")&&t(a,b,this.options)};b.destroy=function(){var a=this._util;this.options.container&&k(this.options.container,function(b){m(b,"scroll",a.validateT)});m(window,"scroll",a.validateT);m(window,"resize",a.validateT);m(window,"resize",a.saveViewportOffsetT);a.count=0;a.images.length=0;a.destroyed=!0};d.validateT=r(function(){f(b)},25,b);d.saveViewportOffsetT=r(function(){q(b.options.offset)},50,b);q(b.options.offset);k(b.options.breakpoints,function(a){if(a.width>=window.screen.width)return n=a.src,!1});h(b)}});
